<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editor Python Online</title>
    <script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(90deg, #2c3e50, #4a6491);
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .main-content {
            display: flex;
            flex-wrap: wrap;
            padding: 20px;
            gap: 20px;
        }
        
        .editor-section, .output-section {
            flex: 1;
            min-width: 300px;
        }
        
        .section-title {
            font-size: 1.3rem;
            margin-bottom: 10px;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .code-editor {
            width: 100%;
            height: 400px;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            resize: vertical;
            background-color: #f8f9fa;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.1);
            line-height: 1.5;
        }
        
        .output-container {
            width: 100%;
            height: 400px;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            background-color: #1e1e1e;
            color: #f0f0f0;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.3);
            white-space: pre-wrap;
            line-height: 1.5;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            padding: 0 20px 20px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 12px 25px;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .run-btn {
            background: linear-gradient(90deg, #27ae60, #2ecc71);
            color: white;
        }
        
        .run-btn:hover:not(:disabled) {
            background: linear-gradient(90deg, #219653, #27ae60);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.4);
        }
        
        .run-btn:disabled {
            background: #95a5a6;
            cursor: not-allowed;
            transform: none;
        }
        
        .clear-btn {
            background: linear-gradient(90deg, #e74c3c, #c0392b);
            color: white;
        }
        
        .clear-btn:hover {
            background: linear-gradient(90deg, #c0392b, #a93226);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(192, 57, 43, 0.4);
        }
        
        .examples-btn {
            background: linear-gradient(90deg, #3498db, #2980b9);
            color: white;
        }
        
        .examples-btn:hover {
            background: linear-gradient(90deg, #2980b9, #2471a3);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }
        
        .status {
            text-align: center;
            padding: 10px;
            font-style: italic;
        }
        
        .status.success {
            color: #27ae60;
        }
        
        .status.error {
            color: #e74c3c;
        }
        
        .status.warning {
            color: #f39c12;
        }
        
        .status.info {
            color: #3498db;
        }
        
        .examples-panel {
            display: none;
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .examples-panel h3 {
            margin-bottom: 15px;
            color: #2c3e50;
        }
        
        .example-item {
            padding: 10px 15px;
            margin-bottom: 10px;
            background-color: white;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s;
            border-left: 4px solid #3498db;
        }
        
        .example-item:hover {
            background-color: #e8f4fc;
        }
        
        .loading {
            text-align: center;
            padding: 40px 20px;
        }
        
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #3498db;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .progress-bar {
            width: 100%;
            height: 6px;
            background-color: #ecf0f1;
            border-radius: 3px;
            margin: 20px auto;
            overflow: hidden;
            max-width: 300px;
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #2980b9);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            color: white;
            margin-top: 20px;
        }
        
        .error-message {
            background-color: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 6px;
            margin: 20px;
            border-left: 4px solid #e74c3c;
        }
        
        .retry-btn {
            background: linear-gradient(90deg, #e67e22, #d35400);
            color: white;
            margin-top: 10px;
        }
        
        .retry-btn:hover {
            background: linear-gradient(90deg, #d35400, #ba4a00);
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .code-editor, .output-container {
                height: 300px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üêç Python em Tempo Real</h1>
            <p class="subtitle">Execute c√≥digo Python diretamente no seu navegador</p>
        </header>
        
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <h3>Carregando Ambiente Python</h3>
            <p>Isso pode levar alguns segundos na primeira execu√ß√£o</p>
            <div class="progress-bar">
                <div class="progress" id="progress-bar"></div>
            </div>
            <p id="loading-status">Inicializando Pyodide...</p>
        </div>
        
        <div id="error-message" class="error-message" style="display: none;">
            <h3>‚ùå Erro ao carregar o ambiente Python</h3>
            <p id="error-details">O ambiente Python n√£o p√¥de ser carregado. Isso pode ser devido a problemas de conex√£o ou compatibilidade do navegador.</p>
            <button class="retry-btn" onclick="initializePyodide()">üîÑ Tentar Novamente</button>
        </div>
        
        <div class="main-content" id="main-content" style="display: none;">
            <div class="editor-section">
                <h2 class="section-title">üìù Editor de C√≥digo</h2>
                <textarea id="code-editor" class="code-editor" placeholder="Digite seu c√≥digo Python aqui..."># Bem-vindo ao Editor Python Online!
# Digite seu c√≥digo abaixo e clique em "Executar"

# Exemplo simples
print("Hello, World!")

# C√°lculo simples
x = 5
y = 3
resultado = x + y
print(f"{x} + {y} = {resultado}")

# Lista de n√∫meros
numeros = [1, 2, 3, 4, 5]
print("N√∫meros:", numeros)

# Soma dos n√∫meros
soma = sum(numeros)
print("Soma dos n√∫meros:", soma)</textarea>
            </div>
            
            <div class="output-section">
                <h2 class="section-title">üì§ Sa√≠da</h2>
                <div id="output-container" class="output-container">A sa√≠da do seu c√≥digo aparecer√° aqui...</div>
            </div>
            
            <div class="controls">
                <button id="run-btn" class="run-btn" disabled>‚ñ∂Ô∏è Executar</button>
                <button id="clear-btn" class="clear-btn">üóëÔ∏è Limpar</button>
                <button id="examples-btn" class="examples-btn">üìö Exemplos</button>
            </div>
            
            <div id="examples-panel" class="examples-panel">
                <h3>Exemplos de C√≥digo</h3>
                <div class="example-item" data-example="hello">Hello World</div>
                <div class="example-item" data-example="fibonacci">Sequ√™ncia de Fibonacci</div>
                <div class="example-item" data-example="calculadora">Calculadora Simples</div>
                <div class="example-item" data-example="jogo">Jogo de Adivinha√ß√£o</div>
                <div class="example-item" data-example="matematica">C√°lculos Matem√°ticos</div>
            </div>
            
            <div class="status info" id="status">
                Carregando ambiente Python...
            </div>
        </div>
    </div>

    <script>
        // Inicializa√ß√£o do Pyodide
        let pyodide;
        let isInitialized = false;
        
        async function initializePyodide() {
            // Mostrar loading e esconder erro
            document.getElementById('loading').style.display = 'block';
            document.getElementById('error-message').style.display = 'none';
            document.getElementById('main-content').style.display = 'none';
            
            try {
                document.getElementById('loading-status').textContent = 'Baixando Pyodide...';
                document.getElementById('progress-bar').style.width = '30%';
                
                // Carregar Pyodide
                pyodide = await loadPyodide();
                
                document.getElementById('loading-status').textContent = 'Configurando ambiente...';
                document.getElementById('progress-bar').style.width = '70%';
                
                // Configurar sistema de captura de sa√≠da SIMPLES
                await pyodide.runPythonAsync(`
                import sys
                import io

                class OutputCapture(io.StringIO):
                    def __init__(self):
                        super().__init__()
                        self.output_buffer = ""
                    
                    def write(self, text):
                        self.output_buffer += text
                        return len(text)
                    
                    def flush(self):
                        result = self.output_buffer
                        self.output_buffer = ""
                        return result

                output_capture = OutputCapture()
                sys.stdout = output_capture
                sys.stderr = output_capture
                `);
                
                document.getElementById('loading-status').textContent = 'Finalizando...';
                document.getElementById('progress-bar').style.width = '100%';
                
                // Aguardar um pouco para mostrar o progresso completo
                await new Promise(resolve => setTimeout(resolve, 500));
                
                // Esconder loading e mostrar conte√∫do principal
                document.getElementById('loading').style.display = 'none';
                document.getElementById('main-content').style.display = 'flex';
                document.getElementById('run-btn').disabled = false;
                
                document.getElementById('status').textContent = '‚úÖ Ambiente Python carregado com sucesso!';
                document.getElementById('status').className = 'status success';
                
                isInitialized = true;
                
                // Executar c√≥digo de exemplo inicial
                setTimeout(runPythonCode, 100);
                
            } catch (error) {
                console.error('Erro ao carregar Pyodide:', error);
                
                document.getElementById('loading').style.display = 'none';
                document.getElementById('error-message').style.display = 'block';
                document.getElementById('error-details').textContent = 
                    `Erro: ${error.message}. Verifique sua conex√£o com a internet e tente novamente.`;
            }
        }
        
        // Executar c√≥digo Python
        async function runPythonCode() {
            if (!isInitialized) {
                document.getElementById('output-container').textContent = 
                    '‚ùå Ambiente Python n√£o est√° carregado. Aguarde a inicializa√ß√£o.';
                return;
            }
            
            const code = document.getElementById('code-editor').value;
            const output = document.getElementById('output-container');
            
            if (!code.trim()) {
                output.textContent = '‚ùå Nenhum c√≥digo para executar.';
                document.getElementById('status').textContent = 'Erro: Nenhum c√≥digo para executar';
                document.getElementById('status').className = 'status error';
                return;
            }
            
            output.textContent = '‚è≥ Executando c√≥digo...\n';
            document.getElementById('status').textContent = 'Executando c√≥digo...';
            document.getElementById('status').className = 'status warning';
            document.getElementById('run-btn').disabled = true;
            
            try {
                // Limpar o buffer de sa√≠da antes de executar
                await pyodide.runPythonAsync(`sys.stdout.flush()`);
                
                // Executar o c√≥digo do usu√°rio
                await pyodide.runPythonAsync(code);
                
                // Capturar toda a sa√≠da de uma vez
                const finalOutput = await pyodide.runPythonAsync(`sys.stdout.flush()`);
                
                // Exibir a sa√≠da apenas uma vez
                if (finalOutput && finalOutput.trim()) {
                    output.textContent = finalOutput;
                } else {
                    output.textContent = '‚úÖ C√≥digo executado, mas n√£o produziu sa√≠da.';
                }
                
                document.getElementById('status').textContent = '‚úÖ C√≥digo executado com sucesso!';
                document.getElementById('status').className = 'status success';
                
            } catch (error) {
                output.textContent = `‚ùå Erro: ${error.message}`;
                document.getElementById('status').textContent = '‚ùå Erro na execu√ß√£o do c√≥digo';
                document.getElementById('status').className = 'status error';
            } finally {
                document.getElementById('run-btn').disabled = false;
            }
        }
        
        // Limpar a sa√≠da
        function clearOutput() {
            document.getElementById('output-container').textContent = 'A sa√≠da do seu c√≥digo aparecer√° aqui...';
            document.getElementById('status').textContent = 'Sa√≠da limpa';
            document.getElementById('status').className = 'status info';
        }
        
        // Alternar visibilidade dos exemplos
        function toggleExamples() {
            const panel = document.getElementById('examples-panel');
            panel.style.display = panel.style.display === 'block' ? 'none' : 'block';
        }
        
        // Carregar exemplos de c√≥digo
        function loadExample(exampleName) {
            const examples = {
                hello: `# Exemplo Hello World
print("Hello, World!")

# Vari√°veis e opera√ß√µes
nome = "Python"
versao = 3.9
print(f"Bem-vindo ao {nome} {versao}")

# Lista de cumprimentos
cumprimentos = ["Ol√°", "Oi", "E a√≠", "Hey"]
for cumprimento in cumprimentos:
    print(f"{cumprimento}, Mundo!")`,
                
                fibonacci: `# Sequ√™ncia de Fibonacci
def fibonacci(n):
    if n <= 1:
        return n
    else:
        return fibonacci(n-1) + fibonacci(n-2)

print("Sequ√™ncia de Fibonacci:")
for i in range(15):
    resultado = fibonacci(i)
    print(f"F({i}) = {resultado}")`,
                
                calculadora: `# Calculadora Simples
def calculadora(a, b, operacao):
    if operacao == '+':
        return a + b
    elif operacao == '-':
        return a - b
    elif operacao == '*':
        return a * b
    elif operacao == '/':
        if b != 0:
            return a / b
        else:
            return "Erro: divis√£o por zero"
    else:
        return "Opera√ß√£o inv√°lida"

# Testando a calculadora
print("üßÆ Calculadora Python")
print("=" * 25)
print(f"10 + 5 = {calculadora(10, 5, '+')}")
print(f"10 - 5 = {calculadora(10, 5, '-')}")
print(f"10 * 5 = {calculadora(10, 5, '*')}")
print(f"10 / 5 = {calculadora(10, 5, '/')}")
print(f"10 / 0 = {calculadora(10, 0, '/')}")`,
                
                jogo: `# Jogo de Adivinha√ß√£o
import random

numero_secreto = random.randint(1, 20)
tentativas = 0
acertou = False

print("üéØ Jogo de Adivinha√ß√£o")
print("Adivinhe o n√∫mero entre 1 e 20")

# Simula√ß√£o de jogadas
while not acertou and tentativas < 5:
    tentativas += 1
    palpite = random.randint(1, 20)  # Palpite aleat√≥rio
    
    print(f"\\nTentativa {tentativas}: {palpite}")
    
    if palpite < numero_secreto:
        print("Dica: Muito baixo! üìâ")
    elif palpite > numero_secreto:
        print("Dica: Muito alto! üìà")
    else:
        print("üéâ Parab√©ns! Voc√™ acertou!")
        acertou = True

if not acertou:
    print(f"\\nüíî Fim de jogo! O n√∫mero era {numero_secreto}.")`,
                
                matematica: `# C√°lculos Matem√°ticos
import math

print("üìä C√°lculos Matem√°ticos")
print("=" * 30)

# N√∫meros para teste
numeros = [2, 5, 9, 16, 25]

for num in numeros:
    print(f"\\nN√∫mero: {num}")
    print(f"  ‚àö{num} = {math.sqrt(num):.2f}")
    print(f"  log({num}) = {math.log(num):.2f}")
    print(f"  {num}¬≤ = {math.pow(num, 2)}")
    print(f"  sin({num}) = {math.sin(num):.4f}")`
            };
            
            if (examples[exampleName]) {
                document.getElementById('code-editor').value = examples[exampleName];
                document.getElementById('examples-panel').style.display = 'none';
                document.getElementById('status').textContent = `üìö Exemplo "${exampleName}" carregado!`;
                document.getElementById('status').className = 'status success';
            }
        }
        
        // Event Listeners
        document.getElementById('run-btn').addEventListener('click', runPythonCode);
        document.getElementById('clear-btn').addEventListener('click', clearOutput);
        document.getElementById('examples-btn').addEventListener('click', toggleExamples);
        
        // Adicionar event listeners para os exemplos
        document.querySelectorAll('.example-item').forEach(item => {
            item.addEventListener('click', () => {
                loadExample(item.getAttribute('data-example'));
            });
        });
        
        // Inicializar Pyodide quando a p√°gina carregar
        window.addEventListener('load', initializePyodide);
    </script>
</body>
</html>